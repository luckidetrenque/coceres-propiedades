---
// Opiniones.astro
---

<section class="py-16 bg-white">
  <div class="max-w-[1200px] mx-auto px-4">
    <!-- Título y descripción -->
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-800 mb-4">Opiniones de Nuestros Clientes</h2>
      <p class="text-gray-600 text-lg max-w-2xl mx-auto">
        La confianza de nuestros clientes es nuestro mayor logro. Conocé qué dicen quienes ya encontraron su lugar ideal con nosotros.
      </p>
    </div>

    <!-- Carrusel de testimonios -->
    <div class="relative">
      <div class="overflow-hidden rounded-lg">
        <div id="testimonials-container" class="flex transition-transform duration-500 ease-in-out">
          
          <!-- Testimonio 1 -->
          <div class="flex-shrink-0 w-full px-4">
            <div class="bg-gray-50 rounded-lg p-8 text-center max-w-3xl mx-auto">
              <!-- Valoración con estrellas -->
              <div class="flex justify-center mb-4">
                <div class="flex space-x-1">
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                </div>
              </div>
              
              <!-- Texto del testimonio -->
              <blockquote class="text-lg text-gray-700 mb-6 italic leading-relaxed">
                "Excelente atención desde el primer contacto. Juan y su equipo nos acompañaron durante todo el proceso de compra de nuestro primer departamento. Muy profesionales y siempre dispuestos a resolver nuestras dudas. Sin dudas los recomendaría."
              </blockquote>
              
              <!-- Foto y datos del cliente -->
              <div class="flex items-center justify-center">
                <div class="w-12 h-12 rounded-full overflow-hidden mr-4 bg-gray-200">
                  <img 
                    src="/cliente-1.jpg" 
                    alt="María González"
                    class="w-full h-full object-cover"
                  />
                </div>
                <div class="text-left">
                  <h4 class="font-semibold text-gray-800">María González</h4>
                  <p class="text-sm text-gray-600">Compradora - Palermo</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Testimonio 2 -->
          <div class="flex-shrink-0 w-full px-4">
            <div class="bg-gray-50 rounded-lg p-8 text-center max-w-3xl mx-auto">
              <!-- Valoración con estrellas -->
              <div class="flex justify-center mb-4">
                <div class="flex space-x-1">
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                </div>
              </div>
              
              <!-- Texto del testimonio -->
              <blockquote class="text-lg text-gray-700 mb-6 italic leading-relaxed">
                "Vendimos nuestra casa con Cóceres Propiedades y la experiencia fue excelente. Carlos nos ayudó con todo el papeleo y logró un precio justo en tiempo récord. Muy contentos con el resultado y el trato recibido."
              </blockquote>
              
              <!-- Foto y datos del cliente -->
              <div class="flex items-center justify-center">
                <div class="w-12 h-12 rounded-full overflow-hidden mr-4 bg-gray-200">
                  <img 
                    src="/cliente-2.jpg" 
                    alt="Roberto Fernández"
                    class="w-full h-full object-cover"
                  />
                </div>
                <div class="text-left">
                  <h4 class="font-semibold text-gray-800">Roberto Fernández</h4>
                  <p class="text-sm text-gray-600">Vendedor - San Isidro</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Testimonio 3 -->
          <div class="flex-shrink-0 w-full px-4">
            <div class="bg-gray-50 rounded-lg p-8 text-center max-w-3xl mx-auto">
              <!-- Valoración con estrellas -->
              <div class="flex justify-center mb-4">
                <div class="flex space-x-1">
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-yellow-400 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                  <svg class="w-5 h-5 text-gray-300 fill-current" viewBox="0 0 20 20">
                    <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/>
                  </svg>
                </div>
              </div>
              
              <!-- Texto del testimonio -->
              <blockquote class="text-lg text-gray-700 mb-6 italic leading-relaxed">
                "Encontré el departamento perfecto para alquilar gracias a María. Su conocimiento del barrio y su paciencia para mostrarme diferentes opciones fue increíble. Proceso súper ágil y transparente en todo momento."
              </blockquote>
              
              <!-- Foto y datos del cliente -->
              <div class="flex items-center justify-center">
                <div class="w-12 h-12 rounded-full overflow-hidden mr-4 bg-gray-200">
                  <img 
                    src="/cliente-3.jpg" 
                    alt="Ana Martínez"
                    class="w-full h-full object-cover"
                  />
                </div>
                <div class="text-left">
                  <h4 class="font-semibold text-gray-800">Ana Martínez</h4>
                  <p class="text-sm text-gray-600">Inquilina - Belgrano</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Flechas de navegación -->
      <button 
        id="prev-testimonial"
        class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 bg-white shadow-lg rounded-full p-2 hover:bg-gray-50 transition-colors duration-200"
      >
        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
      </button>

      <button 
        id="next-testimonial"
        class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 bg-white shadow-lg rounded-full p-2 hover:bg-gray-50 transition-colors duration-200"
      >
        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
      </button>

      <!-- Indicadores -->
      <div class="flex justify-center mt-8 space-x-2">
        <button class="testimonial-dot w-3 h-3 rounded-full bg-sky-600 transition-all duration-300" data-slide="0"></button>
        <button class="testimonial-dot w-3 h-3 rounded-full bg-gray-300 transition-all duration-300" data-slide="1"></button>
        <button class="testimonial-dot w-3 h-3 rounded-full bg-gray-300 transition-all duration-300" data-slide="2"></button>
      </div>
    </div>
  </div>
</section>

<script>
  class TestimonialCarousel {
	currentSlide: number;
	totalSlides: number;
	container: HTMLElement | null;
	prevBtn: HTMLElement | null;
	nextBtn: HTMLElement | null;
	dots: NodeListOf<Element>;
	autoSlideInterval!: number;
    constructor() {
      this.currentSlide = 0;
      this.totalSlides = 3;
      this.container = document.getElementById('testimonials-container');
      this.prevBtn = document.getElementById('prev-testimonial');
      this.nextBtn = document.getElementById('next-testimonial');
      this.dots = document.querySelectorAll('.testimonial-dot');
      
      this.init();
    }

    init() {
      // Event listeners para botones
      this.prevBtn?.addEventListener('click', () => this.prevSlide());
      this.nextBtn?.addEventListener('click', () => this.nextSlide());
      
      // Event listeners para dots
      this.dots.forEach((dot, index) => {
        dot.addEventListener('click', () => this.goToSlide(index));
      });
      
      // Auto-slide cada 6 segundos
      this.autoSlide();
      
      // Pausar auto-slide al hacer hover
      this.container?.addEventListener('mouseenter', () => this.pauseAutoSlide());
      this.container?.addEventListener('mouseleave', () => this.resumeAutoSlide());
    }

    goToSlide(index: number) {
      this.currentSlide = index;
      const translateX = -this.currentSlide * 100;
      
      if (this.container) {
        this.container.style.transform = `translateX(${translateX}%)`;
      }
      
      this.updateDots();
    }

    nextSlide() {
      this.currentSlide = (this.currentSlide + 1) % this.totalSlides;
      this.goToSlide(this.currentSlide);
    }

    prevSlide() {
      this.currentSlide = this.currentSlide === 0 ? this.totalSlides - 1 : this.currentSlide - 1;
      this.goToSlide(this.currentSlide);
    }

    updateDots() {
      this.dots.forEach((dot, index) => {
        if (index === this.currentSlide) {
          dot.classList.remove('bg-gray-300');
          dot.classList.add('bg-sky-600');
        } else {
          dot.classList.remove('bg-sky-600');
          dot.classList.add('bg-gray-300');
        }
      });
    }

    autoSlide() {
      this.autoSlideInterval = setInterval(() => {
        this.nextSlide();
      }, 6000);
    }

    pauseAutoSlide() {
      if (this.autoSlideInterval) {
        clearInterval(this.autoSlideInterval);
      }
    }

    resumeAutoSlide() {
      this.autoSlide();
    }
  }

  // Inicializar carrusel cuando cargue la página
  document.addEventListener('DOMContentLoaded', () => {
    new TestimonialCarousel();
  });
</script>